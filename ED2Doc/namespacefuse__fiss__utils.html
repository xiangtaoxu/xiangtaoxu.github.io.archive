<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ED2: fuse_fiss_utils Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ED2
   </div>
   <div id="projectbrief">Ecosystem Demography Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">fuse_fiss_utils Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines to terminate and fuse patches, and to terminate, fuse and split cohorts.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a31e4835d2465d1400c7cbbb51976b341"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#a31e4835d2465d1400c7cbbb51976b341">sort_cohorts</a> (cpatch)</td></tr>
<tr class="memdesc:a31e4835d2465d1400c7cbbb51976b341"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will sort the cohorts by size (1st = tallest, last = shortest.)  <a href="#a31e4835d2465d1400c7cbbb51976b341">More...</a><br /></td></tr>
<tr class="separator:a31e4835d2465d1400c7cbbb51976b341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dc8f0ad95ff159ac69570ac55856524"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#a5dc8f0ad95ff159ac69570ac55856524">terminate_cohorts</a> (csite, ipa, elim_nplant, elim_lai)</td></tr>
<tr class="memdesc:a5dc8f0ad95ff159ac69570ac55856524"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will eliminate cohorts based on their sizes. This is intended to eliminate cohorts that have little contribution and thus we can speed up the run.  <a href="#a5dc8f0ad95ff159ac69570ac55856524">More...</a><br /></td></tr>
<tr class="separator:a5dc8f0ad95ff159ac69570ac55856524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a480df748f946b24daa940c15d72abfe2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#a480df748f946b24daa940c15d72abfe2">terminate_patches</a> (csite)</td></tr>
<tr class="memdesc:a480df748f946b24daa940c15d72abfe2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will eliminate tiny or empty patches. This is intended to eliminate patches that have little contribution and thus we can speed up the run.  <a href="#a480df748f946b24daa940c15d72abfe2">More...</a><br /></td></tr>
<tr class="separator:a480df748f946b24daa940c15d72abfe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3b0eeed8a63cc2f4b866ac243e25ec6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#ab3b0eeed8a63cc2f4b866ac243e25ec6">rescale_patches</a> (csite)</td></tr>
<tr class="memdesc:ab3b0eeed8a63cc2f4b866ac243e25ec6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will rescale the area of the patches. This is almost the same as the terminate_patches subroutine, except that no patch is removed.  <a href="#ab3b0eeed8a63cc2f4b866ac243e25ec6">More...</a><br /></td></tr>
<tr class="separator:ab3b0eeed8a63cc2f4b866ac243e25ec6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad53341751380c44b17d1e7ec0a5ae824"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#ad53341751380c44b17d1e7ec0a5ae824">fuse_cohorts</a> (csite, ipa, lsl, fuse_initial)</td></tr>
<tr class="memdesc:ad53341751380c44b17d1e7ec0a5ae824"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will perform cohort fusion based on various similarity criteria to determine whether they can be fused with no significant loss of information.  <a href="#ad53341751380c44b17d1e7ec0a5ae824">More...</a><br /></td></tr>
<tr class="separator:ad53341751380c44b17d1e7ec0a5ae824"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba30221565235a7c9cdeadb079d324c5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#aba30221565235a7c9cdeadb079d324c5">split_cohorts</a> (cpatch, green_leaf_factor)</td></tr>
<tr class="memdesc:aba30221565235a7c9cdeadb079d324c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will split two cohorts if its LAI has become too large.  <a href="#aba30221565235a7c9cdeadb079d324c5">More...</a><br /></td></tr>
<tr class="separator:aba30221565235a7c9cdeadb079d324c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fc600375d38f7ddcf60ebf5da725971"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#a2fc600375d38f7ddcf60ebf5da725971">fuse_2_cohorts</a> (cpatch, donc, recc, can_prss, can_shv, lsl, fuse_initial)</td></tr>
<tr class="memdesc:a2fc600375d38f7ddcf60ebf5da725971"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will merge two cohorts into 1.  <a href="#a2fc600375d38f7ddcf60ebf5da725971">More...</a><br /></td></tr>
<tr class="separator:a2fc600375d38f7ddcf60ebf5da725971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a546d7beff2f991a07c8fbba91921ce5f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#a546d7beff2f991a07c8fbba91921ce5f">sort_patches</a> (csite)</td></tr>
<tr class="memdesc:a546d7beff2f991a07c8fbba91921ce5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will sort the patches by age (1st = oldest, last = youngest.)  <a href="#a546d7beff2f991a07c8fbba91921ce5f">More...</a><br /></td></tr>
<tr class="separator:a546d7beff2f991a07c8fbba91921ce5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee30640ff825246fb4c9f5f1f41470be"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#aee30640ff825246fb4c9f5f1f41470be">fuse_patches</a> (cgrid, ifm, fuse_initial)</td></tr>
<tr class="memdesc:aee30640ff825246fb4c9f5f1f41470be"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will perform patch fusion based on some similarity criteria to determine whether they can be fused with no significant loss of information.  <a href="#aee30640ff825246fb4c9f5f1f41470be">More...</a><br /></td></tr>
<tr class="separator:aee30640ff825246fb4c9f5f1f41470be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3a8f1f374137c79a74aed4b42bca8a9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#ad3a8f1f374137c79a74aed4b42bca8a9">fuse_2_patches</a> (csite, donp, recp, mzg, mzs, lsl, ntext_soil, green_leaf_factor, fuse_initial, elim_nplant, elim_lai)</td></tr>
<tr class="memdesc:ad3a8f1f374137c79a74aed4b42bca8a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine will merge two patches into 1.  <a href="#ad3a8f1f374137c79a74aed4b42bca8a9">More...</a><br /></td></tr>
<tr class="separator:ad3a8f1f374137c79a74aed4b42bca8a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae52213c98fe3ffb3ecde24d8ffc6e03"><td class="memItemLeft" align="right" valign="top">real(kind=4) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefuse__fiss__utils.html#aae52213c98fe3ffb3ecde24d8ffc6e03">fuse_msqu</a> (xmean, xmsqu, xwght, ymean, ymsqu, ywght, r_xy, extensive)</td></tr>
<tr class="memdesc:aae52213c98fe3ffb3ecde24d8ffc6e03"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine combines the mean sum of squares of two quantities (x and y).  <a href="#aae52213c98fe3ffb3ecde24d8ffc6e03">More...</a><br /></td></tr>
<tr class="separator:aae52213c98fe3ffb3ecde24d8ffc6e03"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p class="">Routines to terminate and fuse patches, and to terminate, fuse and split cohorts. </p>
<dl class="section author"><dt>Author</dt><dd>Translated from ED1 by David Medivgy, Ryan Knox and Marcos Longo </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a2fc600375d38f7ddcf60ebf5da725971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fc600375d38f7ddcf60ebf5da725971">&#9670;&nbsp;</a></span>fuse_2_cohorts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::fuse_2_cohorts </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1patchtype.html">patchtype</a>), target&#160;</td>
          <td class="paramname"><em>cpatch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>donc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>recc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>can_prss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>can_shv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lsl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fuse_initial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will merge two cohorts into 1. </p>
<p class="">The donating cohort (donc) is the one that will be deallocated, while the receptor cohort (recc) will contain the information from both cohorts. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_a2fc600375d38f7ddcf60ebf5da725971_cgraph.png" border="0" usemap="#namespacefuse__fiss__utils_a2fc600375d38f7ddcf60ebf5da725971_cgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_a2fc600375d38f7ddcf60ebf5da725971_cgraph" id="namespacefuse__fiss__utils_a2fc600375d38f7ddcf60ebf5da725971_cgraph">
<area shape="rect" id="node3" href="namespacetherm__lib.html#ac588ab0dc1c0c52c4c41b847be134ee9" title="therm_lib::uextcm2tl" alt="" coords="212,5,351,35"/>
<area shape="rect" id="node5" href="namespaceallometry.html#ac1523ea0e0ef8d2dd6a429f61a013c1c" title="allometry::dbh2krdepth" alt="" coords="204,59,359,88"/>
<area shape="rect" id="node9" href="namespaceplant__hydro.html#a7cc35f0ea4e11517e3bc7eb75fd19e36" title="Convert relative water content to water potential. " alt="" coords="211,112,352,141"/>
<area shape="rect" id="node11" href="namespacefuse__fiss__utils.html#aae52213c98fe3ffb3ecde24d8ffc6e03" title="This subroutine combines the mean sum of squares of two quantities (x and y). " alt="" coords="192,165,371,195"/>
<area shape="rect" id="node7" href="namespaceallometry.html#aab2b2cee61cac31529246b043121c7de" title="allometry::dbh2vol" alt="" coords="419,59,547,88"/>
<area shape="rect" id="node13" href="numutils_8f90.html#a97ff3973394dba1b9534e055e358de97" title="sngloff" alt="" coords="452,165,513,195"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_a2fc600375d38f7ddcf60ebf5da725971_icgraph.png" border="0" usemap="#namespacefuse__fiss__utils_a2fc600375d38f7ddcf60ebf5da725971_icgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_a2fc600375d38f7ddcf60ebf5da725971_icgraph" id="namespacefuse__fiss__utils_a2fc600375d38f7ddcf60ebf5da725971_icgraph">
<area shape="rect" id="node3" href="namespacefuse__fiss__utils.html#ad53341751380c44b17d1e7ec0a5ae824" title="This subroutine will perform cohort fusion based on various similarity criteria to determine whether ..." alt="" coords="192,39,331,86"/>
<area shape="rect" id="node5" href="namespacedisturbance__utils.html#a29d6db4e94463404643e5c3666c67767" title="disturbance_utils::\lapply_disturbances" alt="" coords="568,5,701,51"/>
<area shape="rect" id="node18" href="namespacefuse__fiss__utils.html#ad3a8f1f374137c79a74aed4b42bca8a9" title="This subroutine will merge two patches into 1. " alt="" coords="379,70,517,117"/>
<area shape="rect" id="node7" href="vegetation__dynamics_8f90.html#ab9ef01736ecab74cd0da4df6c2b63c0f" title="Handles vegetation growth, phenology, reproduction, and disturbance. " alt="" coords="771,13,915,43"/>
<area shape="rect" id="node15" href="vegetation__dynamics_8f90.html#a275be9a740f6c74b8bf5e0a499cb6c49" title="vegetation_dynamics_eq_0" alt="" coords="753,67,932,96"/>
<area shape="rect" id="node9" href="ed__model_8_f90.html#a9804b9ca3fcb1b4e17171d786d50c32c" title="Begins, updates, and outputs results from ecosystem simulation. " alt="" coords="988,65,1065,95"/>
<area shape="rect" id="node11" href="ed__driver_8_f90.html#a5706bd8bee60960fe8166de1870e47da" title="ed_driver" alt="" coords="1120,92,1195,121"/>
<area shape="rect" id="node13" href="edmain_8_f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1243,92,1293,121"/>
<area shape="rect" id="node20" href="namespacefuse__fiss__utils.html#aee30640ff825246fb4c9f5f1f41470be" title="This subroutine will perform patch fusion based on some similarity criteria to determine whether they..." alt="" coords="565,74,704,121"/>
<area shape="rect" id="node22" href="ed__init__atm_8_f90.html#a67ae59514caf7fea8936bca72628f5ca" title="ed_init_atm" alt="" coords="983,119,1071,148"/>
</map>
</div>

</div>
</div>
<a id="ad3a8f1f374137c79a74aed4b42bca8a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3a8f1f374137c79a74aed4b42bca8a9">&#9670;&nbsp;</a></span>fuse_2_patches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::fuse_2_patches </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>donp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>recp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mzg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mzs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lsl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(mzg), intent(in)&#160;</td>
          <td class="paramname"><em>ntext_soil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n_pft), intent(in)&#160;</td>
          <td class="paramname"><em>green_leaf_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fuse_initial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>elim_nplant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>elim_lai</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will merge two patches into 1. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_ad3a8f1f374137c79a74aed4b42bca8a9_cgraph.png" border="0" usemap="#namespacefuse__fiss__utils_ad3a8f1f374137c79a74aed4b42bca8a9_cgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_ad3a8f1f374137c79a74aed4b42bca8a9_cgraph" id="namespacefuse__fiss__utils_ad3a8f1f374137c79a74aed4b42bca8a9_cgraph">
<area shape="rect" id="node3" href="namespacetherm__lib.html#ac588ab0dc1c0c52c4c41b847be134ee9" title="therm_lib::uextcm2tl" alt="" coords="665,40,804,69"/>
<area shape="rect" id="node5" href="namespacebudget__utils.html#ac092645bc3b3bd0dcfa2cdedc2451c58" title="budget_utils::update\l_budget" alt="" coords="207,734,345,781"/>
<area shape="rect" id="node15" href="ed__type__init_8f90.html#aa6a689a6e6981ff6c33afcb419db9b28" title="new_patch_sfc_props" alt="" coords="201,93,351,123"/>
<area shape="rect" id="node26" href="namespacefuse__fiss__utils.html#aae52213c98fe3ffb3ecde24d8ffc6e03" title="This subroutine combines the mean sum of squares of two quantities (x and y). " alt="" coords="645,149,824,179"/>
<area shape="rect" id="node30" href="namespaceupdate__derived__props__module.html#a304000a1024ed8b1bb99a278f951cd59" title="update_derived_props\l_module::update_patch\l_thermo_props" alt="" coords="197,864,355,928"/>
<area shape="rect" id="node34" href="namespaceupdate__derived__props__module.html#a32f02a976fa5385f607cb4fa4d1aa552" title="update_derived_props\l_module::update_cohort\l_extensive_props" alt="" coords="423,493,583,557"/>
<area shape="rect" id="node36" href="namespacefuse__fiss__utils.html#a31e4835d2465d1400c7cbbb51976b341" title="This subroutine will sort the cohorts by size (1st = tallest, last = shortest.) " alt="" coords="435,317,571,363"/>
<area shape="rect" id="node38" href="namespacefuse__fiss__utils.html#ad53341751380c44b17d1e7ec0a5ae824" title="This subroutine will perform cohort fusion based on various similarity criteria to determine whether ..." alt="" coords="207,253,345,299"/>
<area shape="rect" id="node57" href="namespacefuse__fiss__utils.html#a5dc8f0ad95ff159ac69570ac55856524" title="This subroutine will eliminate cohorts based on their sizes. This is intended to eliminate cohorts th..." alt="" coords="192,373,360,419"/>
<area shape="rect" id="node60" href="namespacefuse__fiss__utils.html#aba30221565235a7c9cdeadb079d324c5" title="This subroutine will split two cohorts if its LAI has become too large. " alt="" coords="207,442,345,489"/>
<area shape="rect" id="node67" href="namespaceupdate__derived__props__module.html#afb0be8a22ce7ffce3fa96d10c2ee6408" title="update_derived_props\l_module::update_patch\l_derived_props" alt="" coords="197,613,355,677"/>
<area shape="rect" id="node71" href="namespacepatch__pft__size__profile__mod.html#a3e4556647869506dcb0b3646c239509a" title="patch_pft_size_profile\l_mod::patch_pft_size_profile" alt="" coords="408,581,597,627"/>
<area shape="rect" id="node7" href="namespacebudget__utils.html#aa1c4f8466010b1673f2914f1bfe9b6ee" title="budget_utils::compute\l_co2_storage" alt="" coords="428,703,577,750"/>
<area shape="rect" id="node9" href="namespacebudget__utils.html#ad0c764047c557100b3a3cdcd836103a0" title="budget_utils::compute\l_water_storage" alt="" coords="428,773,577,819"/>
<area shape="rect" id="node11" href="namespacebudget__utils.html#a319c5f7252c344bcebbd162593e25ec8" title="budget_utils::compute\l_energy_storage" alt="" coords="428,842,577,889"/>
<area shape="rect" id="node13" href="namespacetherm__lib.html#addd05382298a8487d09d7f6e2664dd62" title="therm_lib::tq2enthalpy" alt="" coords="660,851,809,880"/>
<area shape="rect" id="node18" href="namespaceed__therm__lib.html#aa6561183a4fc06ca1c9430914a5b6032" title="ed_therm_lib::ed_grndvap" alt="" coords="417,93,588,123"/>
<area shape="rect" id="node20" href="namespacetherm__lib.html#a44ab3a68e6060bf4afbfc504e3a8c633" title="therm_lib::qslif" alt="" coords="681,93,788,123"/>
<area shape="rect" id="node22" href="namespacetherm__lib.html#a109004866b1542dfcfa1da1e5130d3c9" title="therm_lib::esif" alt="" coords="884,95,988,124"/>
<area shape="rect" id="node24" href="namespacetherm__lib.html#a82ae02323247d6435153002a309552fb" title="therm_lib::eslf" alt="" coords="884,41,988,71"/>
<area shape="rect" id="node28" href="numutils_8f90.html#a97ff3973394dba1b9534e055e358de97" title="sngloff" alt="" coords="905,149,967,179"/>
<area shape="rect" id="node32" href="namespacetherm__lib.html#a60b714e3ae5457604df59afaf6904acd" title="therm_lib::idealdenssh" alt="" coords="427,912,579,941"/>
<area shape="rect" id="node40" href="namespaceallometry.html#a45ced9bf9ccd03debe8def35b579f4bd" title="allometry::size2bl" alt="" coords="673,451,796,480"/>
<area shape="rect" id="node44" href="namespacefuse__fiss__utils.html#a2fc600375d38f7ddcf60ebf5da725971" title="This subroutine will merge two cohorts into 1. " alt="" coords="433,197,572,243"/>
<area shape="rect" id="node54" href="fatal__error_8_f90.html#a2a2bff228716ab48a81c795b348d1665" title="fatal_error" alt="" coords="463,387,543,416"/>
<area shape="rect" id="node42" href="namespaceallometry.html#a31aa8db06e86ec74efb5e692417399df" title="allometry::h2dbh" alt="" coords="877,451,995,480"/>
<area shape="rect" id="node47" href="namespaceallometry.html#ac1523ea0e0ef8d2dd6a429f61a013c1c" title="allometry::dbh2krdepth" alt="" coords="657,259,812,288"/>
<area shape="rect" id="node51" href="namespaceplant__hydro.html#a7cc35f0ea4e11517e3bc7eb75fd19e36" title="Convert relative water content to water potential. " alt="" coords="664,205,805,235"/>
<area shape="rect" id="node49" href="namespaceallometry.html#aab2b2cee61cac31529246b043121c7de" title="allometry::dbh2vol" alt="" coords="872,259,1000,288"/>
<area shape="rect" id="node62" href="namespaceallometry.html#a56f11dc07da4d5e7114dc37d6cc5f2cc" title="allometry::dbh2h" alt="" coords="444,440,561,469"/>
<area shape="rect" id="node69" href="namespaceallometry.html#ab6a3d3302db0096b21354babe768677b" title="allometry::ed_biomass" alt="" coords="427,651,579,680"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_ad3a8f1f374137c79a74aed4b42bca8a9_icgraph.png" border="0" usemap="#namespacefuse__fiss__utils_ad3a8f1f374137c79a74aed4b42bca8a9_icgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_ad3a8f1f374137c79a74aed4b42bca8a9_icgraph" id="namespacefuse__fiss__utils_ad3a8f1f374137c79a74aed4b42bca8a9_icgraph">
<area shape="rect" id="node3" href="namespacefuse__fiss__utils.html#aee30640ff825246fb4c9f5f1f41470be" title="This subroutine will perform patch fusion based on some similarity criteria to determine whether they..." alt="" coords="192,49,331,95"/>
<area shape="rect" id="node5" href="ed__init__atm_8_f90.html#a67ae59514caf7fea8936bca72628f5ca" title="ed_init_atm" alt="" coords="609,5,697,35"/>
<area shape="rect" id="node11" href="vegetation__dynamics_8f90.html#ab9ef01736ecab74cd0da4df6c2b63c0f" title="Handles vegetation growth, phenology, reproduction, and disturbance. " alt="" coords="397,57,541,87"/>
<area shape="rect" id="node16" href="vegetation__dynamics_8f90.html#a275be9a740f6c74b8bf5e0a499cb6c49" title="vegetation_dynamics_eq_0" alt="" coords="380,111,559,140"/>
<area shape="rect" id="node7" href="ed__driver_8_f90.html#a5706bd8bee60960fe8166de1870e47da" title="ed_driver" alt="" coords="747,32,821,61"/>
<area shape="rect" id="node9" href="edmain_8_f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="869,32,920,61"/>
<area shape="rect" id="node13" href="ed__model_8_f90.html#a9804b9ca3fcb1b4e17171d786d50c32c" title="Begins, updates, and outputs results from ecosystem simulation. " alt="" coords="615,59,692,88"/>
</map>
</div>

</div>
</div>
<a id="ad53341751380c44b17d1e7ec0a5ae824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad53341751380c44b17d1e7ec0a5ae824">&#9670;&nbsp;</a></span>fuse_cohorts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::fuse_cohorts </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lsl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fuse_initial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will perform cohort fusion based on various similarity criteria to determine whether they can be fused with no significant loss of information. </p>
<p class="">The user is welcome to set up a benchmark, but should be aware that no miracles will happen here. If there are more very distinct cohorts than maxcohort, then the user will need to live with that and accept life is not always fair with those with limited computational resources. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_ad53341751380c44b17d1e7ec0a5ae824_cgraph.png" border="0" usemap="#namespacefuse__fiss__utils_ad53341751380c44b17d1e7ec0a5ae824_cgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_ad53341751380c44b17d1e7ec0a5ae824_cgraph" id="namespacefuse__fiss__utils_ad53341751380c44b17d1e7ec0a5ae824_cgraph">
<area shape="rect" id="node3" href="namespaceallometry.html#a45ced9bf9ccd03debe8def35b579f4bd" title="allometry::size2bl" alt="" coords="200,28,323,57"/>
<area shape="rect" id="node7" href="namespacefuse__fiss__utils.html#a2fc600375d38f7ddcf60ebf5da725971" title="This subroutine will merge two cohorts into 1. " alt="" coords="192,103,331,150"/>
<area shape="rect" id="node21" href="fatal__error_8_f90.html#a2a2bff228716ab48a81c795b348d1665" title="fatal_error" alt="" coords="221,173,301,203"/>
<area shape="rect" id="node23" href="namespacefuse__fiss__utils.html#a31e4835d2465d1400c7cbbb51976b341" title="This subroutine will sort the cohorts by size (1st = tallest, last = shortest.) " alt="" coords="193,226,329,273"/>
<area shape="rect" id="node5" href="namespaceallometry.html#a31aa8db06e86ec74efb5e692417399df" title="allometry::h2dbh" alt="" coords="409,5,527,35"/>
<area shape="rect" id="node9" href="namespacetherm__lib.html#ac588ab0dc1c0c52c4c41b847be134ee9" title="therm_lib::uextcm2tl" alt="" coords="399,59,537,88"/>
<area shape="rect" id="node11" href="namespaceallometry.html#ac1523ea0e0ef8d2dd6a429f61a013c1c" title="allometry::dbh2krdepth" alt="" coords="391,112,545,141"/>
<area shape="rect" id="node15" href="namespaceplant__hydro.html#a7cc35f0ea4e11517e3bc7eb75fd19e36" title="Convert relative water content to water potential. " alt="" coords="397,165,539,195"/>
<area shape="rect" id="node17" href="namespacefuse__fiss__utils.html#aae52213c98fe3ffb3ecde24d8ffc6e03" title="This subroutine combines the mean sum of squares of two quantities (x and y). " alt="" coords="379,219,557,248"/>
<area shape="rect" id="node13" href="namespaceallometry.html#aab2b2cee61cac31529246b043121c7de" title="allometry::dbh2vol" alt="" coords="605,112,733,141"/>
<area shape="rect" id="node19" href="numutils_8f90.html#a97ff3973394dba1b9534e055e358de97" title="sngloff" alt="" coords="639,219,700,248"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_ad53341751380c44b17d1e7ec0a5ae824_icgraph.png" border="0" usemap="#namespacefuse__fiss__utils_ad53341751380c44b17d1e7ec0a5ae824_icgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_ad53341751380c44b17d1e7ec0a5ae824_icgraph" id="namespacefuse__fiss__utils_ad53341751380c44b17d1e7ec0a5ae824_icgraph">
<area shape="rect" id="node3" href="namespacedisturbance__utils.html#a29d6db4e94463404643e5c3666c67767" title="disturbance_utils::\lapply_disturbances" alt="" coords="381,5,515,51"/>
<area shape="rect" id="node16" href="namespacefuse__fiss__utils.html#ad3a8f1f374137c79a74aed4b42bca8a9" title="This subroutine will merge two patches into 1. " alt="" coords="192,70,331,117"/>
<area shape="rect" id="node5" href="vegetation__dynamics_8f90.html#ab9ef01736ecab74cd0da4df6c2b63c0f" title="Handles vegetation growth, phenology, reproduction, and disturbance. " alt="" coords="584,13,728,43"/>
<area shape="rect" id="node13" href="vegetation__dynamics_8f90.html#a275be9a740f6c74b8bf5e0a499cb6c49" title="vegetation_dynamics_eq_0" alt="" coords="567,67,745,96"/>
<area shape="rect" id="node7" href="ed__model_8_f90.html#a9804b9ca3fcb1b4e17171d786d50c32c" title="Begins, updates, and outputs results from ecosystem simulation. " alt="" coords="801,65,879,95"/>
<area shape="rect" id="node9" href="ed__driver_8_f90.html#a5706bd8bee60960fe8166de1870e47da" title="ed_driver" alt="" coords="933,92,1008,121"/>
<area shape="rect" id="node11" href="edmain_8_f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1056,92,1107,121"/>
<area shape="rect" id="node18" href="namespacefuse__fiss__utils.html#aee30640ff825246fb4c9f5f1f41470be" title="This subroutine will perform patch fusion based on some similarity criteria to determine whether they..." alt="" coords="379,74,517,121"/>
<area shape="rect" id="node20" href="ed__init__atm_8_f90.html#a67ae59514caf7fea8936bca72628f5ca" title="ed_init_atm" alt="" coords="796,119,884,148"/>
</map>
</div>

</div>
</div>
<a id="aae52213c98fe3ffb3ecde24d8ffc6e03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae52213c98fe3ffb3ecde24d8ffc6e03">&#9670;&nbsp;</a></span>fuse_msqu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=4) function fuse_fiss_utils::fuse_msqu </td>
          <td>(</td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>xmean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>xmsqu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>xwght</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>ymean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>ymsqu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>ywght</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>r_xy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>extensive</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine combines the mean sum of squares of two quantities (x and y). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_aae52213c98fe3ffb3ecde24d8ffc6e03_cgraph.png" border="0" usemap="#namespacefuse__fiss__utils_aae52213c98fe3ffb3ecde24d8ffc6e03_cgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_aae52213c98fe3ffb3ecde24d8ffc6e03_cgraph" id="namespacefuse__fiss__utils_aae52213c98fe3ffb3ecde24d8ffc6e03_cgraph">
<area shape="rect" id="node3" href="numutils_8f90.html#a97ff3973394dba1b9534e055e358de97" title="sngloff" alt="" coords="232,5,293,35"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_aae52213c98fe3ffb3ecde24d8ffc6e03_icgraph.png" border="0" usemap="#namespacefuse__fiss__utils_aae52213c98fe3ffb3ecde24d8ffc6e03_icgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_aae52213c98fe3ffb3ecde24d8ffc6e03_icgraph" id="namespacefuse__fiss__utils_aae52213c98fe3ffb3ecde24d8ffc6e03_icgraph">
<area shape="rect" id="node3" href="namespacefuse__fiss__utils.html#a2fc600375d38f7ddcf60ebf5da725971" title="This subroutine will merge two cohorts into 1. " alt="" coords="232,11,371,58"/>
<area shape="rect" id="node20" href="namespacefuse__fiss__utils.html#ad3a8f1f374137c79a74aed4b42bca8a9" title="This subroutine will merge two patches into 1. " alt="" coords="605,71,744,118"/>
<area shape="rect" id="node5" href="namespacefuse__fiss__utils.html#ad53341751380c44b17d1e7ec0a5ae824" title="This subroutine will perform cohort fusion based on various similarity criteria to determine whether ..." alt="" coords="419,11,557,58"/>
<area shape="rect" id="node7" href="namespacedisturbance__utils.html#a29d6db4e94463404643e5c3666c67767" title="disturbance_utils::\lapply_disturbances" alt="" coords="795,5,928,51"/>
<area shape="rect" id="node9" href="vegetation__dynamics_8f90.html#ab9ef01736ecab74cd0da4df6c2b63c0f" title="Handles vegetation growth, phenology, reproduction, and disturbance. " alt="" coords="997,13,1141,43"/>
<area shape="rect" id="node17" href="vegetation__dynamics_8f90.html#a275be9a740f6c74b8bf5e0a499cb6c49" title="vegetation_dynamics_eq_0" alt="" coords="980,67,1159,96"/>
<area shape="rect" id="node11" href="ed__model_8_f90.html#a9804b9ca3fcb1b4e17171d786d50c32c" title="Begins, updates, and outputs results from ecosystem simulation. " alt="" coords="1215,65,1292,95"/>
<area shape="rect" id="node13" href="ed__driver_8_f90.html#a5706bd8bee60960fe8166de1870e47da" title="ed_driver" alt="" coords="1347,92,1421,121"/>
<area shape="rect" id="node15" href="edmain_8_f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1469,92,1520,121"/>
<area shape="rect" id="node22" href="namespacefuse__fiss__utils.html#aee30640ff825246fb4c9f5f1f41470be" title="This subroutine will perform patch fusion based on some similarity criteria to determine whether they..." alt="" coords="792,74,931,121"/>
<area shape="rect" id="node24" href="ed__init__atm_8_f90.html#a67ae59514caf7fea8936bca72628f5ca" title="ed_init_atm" alt="" coords="1209,119,1297,148"/>
</map>
</div>

</div>
</div>
<a id="aee30640ff825246fb4c9f5f1f41470be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee30640ff825246fb4c9f5f1f41470be">&#9670;&nbsp;</a></span>fuse_patches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::fuse_patches </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1edtype.html">edtype</a>), target&#160;</td>
          <td class="paramname"><em>cgrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ifm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fuse_initial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will perform patch fusion based on some similarity criteria to determine whether they can be fused with no significant loss of information. </p>
<p class="">The user is welcome to set up a benchmark, but they should be aware that no miracles will happen here. If there are more very distinct patches than maxpatch, then the user will need to live with that and accept life is not always fair with those with limited computational resources. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_aee30640ff825246fb4c9f5f1f41470be_cgraph.png" border="0" usemap="#namespacefuse__fiss__utils_aee30640ff825246fb4c9f5f1f41470be_cgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_aee30640ff825246fb4c9f5f1f41470be_cgraph" id="namespacefuse__fiss__utils_aee30640ff825246fb4c9f5f1f41470be_cgraph">
<area shape="rect" id="node3" href="namespacepatch__pft__size__profile__mod.html#a3e4556647869506dcb0b3646c239509a" title="patch_pft_size_profile\l_mod::patch_pft_size_profile" alt="" coords="595,5,784,51"/>
<area shape="rect" id="node9" href="namespacefuse__fiss__utils.html#ad3a8f1f374137c79a74aed4b42bca8a9" title="This subroutine will merge two patches into 1. " alt="" coords="192,553,331,599"/>
<area shape="rect" id="node59" href="fatal__error_8_f90.html#a2a2bff228716ab48a81c795b348d1665" title="fatal_error" alt="" coords="649,755,729,784"/>
<area shape="rect" id="node78" href="namespacefuse__fiss__utils.html#a546d7beff2f991a07c8fbba91921ce5f" title="This subroutine will sort the patches by age (1st = oldest, last = youngest.) " alt="" coords="193,922,329,969"/>
<area shape="rect" id="node5" href="namespaceallometry.html#a45ced9bf9ccd03debe8def35b579f4bd" title="allometry::size2bl" alt="" coords="860,388,983,417"/>
<area shape="rect" id="node7" href="namespaceallometry.html#a31aa8db06e86ec74efb5e692417399df" title="allometry::h2dbh" alt="" coords="1064,388,1181,417"/>
<area shape="rect" id="node11" href="namespacetherm__lib.html#ac588ab0dc1c0c52c4c41b847be134ee9" title="therm_lib::uextcm2tl" alt="" coords="852,441,991,471"/>
<area shape="rect" id="node13" href="namespacebudget__utils.html#ac092645bc3b3bd0dcfa2cdedc2451c58" title="budget_utils::update\l_budget" alt="" coords="393,235,532,282"/>
<area shape="rect" id="node23" href="ed__type__init_8f90.html#aa6a689a6e6981ff6c33afcb419db9b28" title="new_patch_sfc_props" alt="" coords="388,371,537,400"/>
<area shape="rect" id="node34" href="namespacefuse__fiss__utils.html#aae52213c98fe3ffb3ecde24d8ffc6e03" title="This subroutine combines the mean sum of squares of two quantities (x and y). " alt="" coords="832,924,1011,953"/>
<area shape="rect" id="node38" href="namespaceupdate__derived__props__module.html#a304000a1024ed8b1bb99a278f951cd59" title="update_derived_props\l_module::update_patch\l_thermo_props" alt="" coords="384,475,541,539"/>
<area shape="rect" id="node42" href="namespaceupdate__derived__props__module.html#a32f02a976fa5385f607cb4fa4d1aa552" title="update_derived_props\l_module::update_cohort\l_extensive_props" alt="" coords="609,544,769,608"/>
<area shape="rect" id="node44" href="namespacefuse__fiss__utils.html#a31e4835d2465d1400c7cbbb51976b341" title="This subroutine will sort the cohorts by size (1st = tallest, last = shortest.) " alt="" coords="621,685,757,731"/>
<area shape="rect" id="node46" href="namespacefuse__fiss__utils.html#ad53341751380c44b17d1e7ec0a5ae824" title="This subroutine will perform cohort fusion based on various similarity criteria to determine whether ..." alt="" coords="393,802,532,849"/>
<area shape="rect" id="node62" href="namespacefuse__fiss__utils.html#a5dc8f0ad95ff159ac69570ac55856524" title="This subroutine will eliminate cohorts based on their sizes. This is intended to eliminate cohorts th..." alt="" coords="379,733,547,779"/>
<area shape="rect" id="node65" href="namespacefuse__fiss__utils.html#aba30221565235a7c9cdeadb079d324c5" title="This subroutine will split two cohorts if its LAI has become too large. " alt="" coords="393,613,532,659"/>
<area shape="rect" id="node72" href="namespaceupdate__derived__props__module.html#afb0be8a22ce7ffce3fa96d10c2ee6408" title="update_derived_props\l_module::update_patch\l_derived_props" alt="" coords="384,116,541,180"/>
<area shape="rect" id="node15" href="namespacebudget__utils.html#aa1c4f8466010b1673f2914f1bfe9b6ee" title="budget_utils::compute\l_co2_storage" alt="" coords="615,197,764,243"/>
<area shape="rect" id="node17" href="namespacebudget__utils.html#ad0c764047c557100b3a3cdcd836103a0" title="budget_utils::compute\l_water_storage" alt="" coords="615,266,764,313"/>
<area shape="rect" id="node19" href="namespacebudget__utils.html#a319c5f7252c344bcebbd162593e25ec8" title="budget_utils::compute\l_energy_storage" alt="" coords="615,127,764,174"/>
<area shape="rect" id="node21" href="namespacetherm__lib.html#addd05382298a8487d09d7f6e2664dd62" title="therm_lib::tq2enthalpy" alt="" coords="847,136,996,165"/>
<area shape="rect" id="node26" href="namespaceed__therm__lib.html#aa6561183a4fc06ca1c9430914a5b6032" title="ed_therm_lib::ed_grndvap" alt="" coords="604,336,775,365"/>
<area shape="rect" id="node28" href="namespacetherm__lib.html#a44ab3a68e6060bf4afbfc504e3a8c633" title="therm_lib::qslif" alt="" coords="868,335,975,364"/>
<area shape="rect" id="node30" href="namespacetherm__lib.html#a109004866b1542dfcfa1da1e5130d3c9" title="therm_lib::esif" alt="" coords="1071,335,1175,364"/>
<area shape="rect" id="node32" href="namespacetherm__lib.html#a82ae02323247d6435153002a309552fb" title="therm_lib::eslf" alt="" coords="1071,281,1175,311"/>
<area shape="rect" id="node36" href="numutils_8f90.html#a97ff3973394dba1b9534e055e358de97" title="sngloff" alt="" coords="1092,924,1153,953"/>
<area shape="rect" id="node40" href="namespacetherm__lib.html#a60b714e3ae5457604df59afaf6904acd" title="therm_lib::idealdenssh" alt="" coords="613,491,765,520"/>
<area shape="rect" id="node49" href="namespacefuse__fiss__utils.html#a2fc600375d38f7ddcf60ebf5da725971" title="This subroutine will merge two cohorts into 1. " alt="" coords="620,858,759,905"/>
<area shape="rect" id="node52" href="namespaceallometry.html#ac1523ea0e0ef8d2dd6a429f61a013c1c" title="allometry::dbh2krdepth" alt="" coords="844,869,999,899"/>
<area shape="rect" id="node56" href="namespaceplant__hydro.html#a7cc35f0ea4e11517e3bc7eb75fd19e36" title="Convert relative water content to water potential. " alt="" coords="851,816,992,845"/>
<area shape="rect" id="node54" href="namespaceallometry.html#aab2b2cee61cac31529246b043121c7de" title="allometry::dbh2vol" alt="" coords="1059,869,1187,899"/>
<area shape="rect" id="node67" href="namespaceallometry.html#a56f11dc07da4d5e7114dc37d6cc5f2cc" title="allometry::dbh2h" alt="" coords="631,632,748,661"/>
<area shape="rect" id="node74" href="namespaceallometry.html#ab6a3d3302db0096b21354babe768677b" title="allometry::ed_biomass" alt="" coords="613,75,765,104"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_aee30640ff825246fb4c9f5f1f41470be_icgraph.png" border="0" usemap="#namespacefuse__fiss__utils_aee30640ff825246fb4c9f5f1f41470be_icgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_aee30640ff825246fb4c9f5f1f41470be_icgraph" id="namespacefuse__fiss__utils_aee30640ff825246fb4c9f5f1f41470be_icgraph">
<area shape="rect" id="node3" href="ed__init__atm_8_f90.html#a67ae59514caf7fea8936bca72628f5ca" title="ed_init_atm" alt="" coords="423,5,511,35"/>
<area shape="rect" id="node9" href="vegetation__dynamics_8f90.html#ab9ef01736ecab74cd0da4df6c2b63c0f" title="Handles vegetation growth, phenology, reproduction, and disturbance. " alt="" coords="211,57,355,87"/>
<area shape="rect" id="node14" href="vegetation__dynamics_8f90.html#a275be9a740f6c74b8bf5e0a499cb6c49" title="vegetation_dynamics_eq_0" alt="" coords="193,111,372,140"/>
<area shape="rect" id="node5" href="ed__driver_8_f90.html#a5706bd8bee60960fe8166de1870e47da" title="ed_driver" alt="" coords="560,32,635,61"/>
<area shape="rect" id="node7" href="edmain_8_f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="683,32,733,61"/>
<area shape="rect" id="node11" href="ed__model_8_f90.html#a9804b9ca3fcb1b4e17171d786d50c32c" title="Begins, updates, and outputs results from ecosystem simulation. " alt="" coords="428,59,505,88"/>
</map>
</div>

</div>
</div>
<a id="ab3b0eeed8a63cc2f4b866ac243e25ec6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3b0eeed8a63cc2f4b866ac243e25ec6">&#9670;&nbsp;</a></span>rescale_patches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::rescale_patches </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will rescale the area of the patches. This is almost the same as the terminate_patches subroutine, except that no patch is removed. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_ab3b0eeed8a63cc2f4b866ac243e25ec6_cgraph.png" border="0" usemap="#namespacefuse__fiss__utils_ab3b0eeed8a63cc2f4b866ac243e25ec6_cgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_ab3b0eeed8a63cc2f4b866ac243e25ec6_cgraph" id="namespacefuse__fiss__utils_ab3b0eeed8a63cc2f4b866ac243e25ec6_cgraph">
<area shape="rect" id="node3" href="namespaceallometry.html#a45ced9bf9ccd03debe8def35b579f4bd" title="allometry::size2bl" alt="" coords="231,5,353,35"/>
<area shape="rect" id="node7" href="namespaceupdate__derived__props__module.html#a32f02a976fa5385f607cb4fa4d1aa552" title="update_derived_props\l_module::update_cohort\l_extensive_props" alt="" coords="212,59,372,123"/>
<area shape="rect" id="node9" href="fatal__error_8_f90.html#a2a2bff228716ab48a81c795b348d1665" title="fatal_error" alt="" coords="252,147,332,176"/>
<area shape="rect" id="node5" href="namespaceallometry.html#a31aa8db06e86ec74efb5e692417399df" title="allometry::h2dbh" alt="" coords="423,5,540,35"/>
</map>
</div>

</div>
</div>
<a id="a31e4835d2465d1400c7cbbb51976b341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31e4835d2465d1400c7cbbb51976b341">&#9670;&nbsp;</a></span>sort_cohorts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::sort_cohorts </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1patchtype.html">patchtype</a>), target&#160;</td>
          <td class="paramname"><em>cpatch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will sort the cohorts by size (1st = tallest, last = shortest.) </p>
<p class="">In case there is a tie (for example, when 2 cohorts have reached the maximum possible height, then we use DBH for tie breaking, and if they have the exact same DBH, then we simply pick the lowest index (as they are exactly the same). This could cause some problems when the new grass allometry is implemented, though. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_a31e4835d2465d1400c7cbbb51976b341_icgraph.png" border="0" usemap="#namespacefuse__fiss__utils_a31e4835d2465d1400c7cbbb51976b341_icgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_a31e4835d2465d1400c7cbbb51976b341_icgraph" id="namespacefuse__fiss__utils_a31e4835d2465d1400c7cbbb51976b341_icgraph">
<area shape="rect" id="node3" href="namespacedisturbance__utils.html#ac78f23ae05ca7cd196ebeeda52e66507" title="disturbance_utils::\lplant_patch" alt="" coords="209,406,337,452"/>
<area shape="rect" id="node23" href="namespacedisturbance__utils.html#adea8e04f93328f6e7137a5c490d0615a" title="disturbance_utils::\lprune_lianas" alt="" coords="209,286,337,332"/>
<area shape="rect" id="node26" href="ed__bigleaf__init_8f90.html#a1e7ca0536a5eed8f8eaee3c6271bcbde" title="ed_bigleaf_init" alt="" coords="447,830,551,860"/>
<area shape="rect" id="node31" href="namespaceed__nbg__init.html#afbe4e1b96c81d4643f2b9e97fb7d2dd8" title="ed_nbg_init::init_nbg\l_cohorts" alt="" coords="203,876,344,923"/>
<area shape="rect" id="node36" href="namespaceed__nbg__init.html#ad7022181b12aec0f7e45270a2877dd49" title="ed_nbg_init::init_cohorts\l_by_layers" alt="" coords="192,802,355,848"/>
<area shape="rect" id="node39" href="ed__read__ed10__20__history_8f90.html#ae4e49e107b22c0bb119ee87348e513b8" title="read_ed10_ed20_history_file" alt="" coords="405,777,592,806"/>
<area shape="rect" id="node42" href="namespacefuse__fiss__utils.html#a5dc8f0ad95ff159ac69570ac55856524" title="This subroutine will eliminate cohorts based on their sizes. This is intended to eliminate cohorts th..." alt="" coords="189,555,357,602"/>
<area shape="rect" id="node59" href="namespacefuse__fiss__utils.html#ad3a8f1f374137c79a74aed4b42bca8a9" title="This subroutine will merge two patches into 1. " alt="" coords="429,46,568,92"/>
<area shape="rect" id="node68" href="namespacefuse__fiss__utils.html#ad53341751380c44b17d1e7ec0a5ae824" title="This subroutine will perform cohort fusion based on various similarity criteria to determine whether ..." alt="" coords="204,216,343,263"/>
<area shape="rect" id="node72" href="namespacefuse__fiss__utils.html#aba30221565235a7c9cdeadb079d324c5" title="This subroutine will split two cohorts if its LAI has become too large. " alt="" coords="204,46,343,92"/>
<area shape="rect" id="node76" href="namespacegrowth__balive.html#a7781ae229b2399c90d50858382665ee8" title="Updates living biomass. " alt="" coords="641,192,809,221"/>
<area shape="rect" id="node80" href="namespacereproduction__module.html#ac201580dce4b65ddfe09b9e9cf32b91b" title="reproduction_module\l::reproduction" alt="" coords="655,346,796,392"/>
<area shape="rect" id="node83" href="namespacereproduction__module.html#a6f519f25524698c2d30d646abbac9727" title="reproduction_module\l::reproduction_eq_0" alt="" coords="655,122,796,168"/>
<area shape="rect" id="node86" href="namespacestructural__growth__module.html#aa974ce442fda8686fd4d88a42b0f150c" title="structural_growth_module\l::structural_growth" alt="" coords="640,427,811,474"/>
<area shape="rect" id="node5" href="namespacedisturbance__utils.html#a29d6db4e94463404643e5c3666c67767" title="disturbance_utils::\lapply_disturbances" alt="" coords="432,286,565,332"/>
<area shape="rect" id="node18" href="events_8f90.html#a3fcb64b4de4ae9408c3e365f6cbd1be6" title="event_planting" alt="" coords="445,406,552,436"/>
<area shape="rect" id="node7" href="vegetation__dynamics_8f90.html#ab9ef01736ecab74cd0da4df6c2b63c0f" title="Handles vegetation growth, phenology, reproduction, and disturbance. " alt="" coords="877,294,1021,324"/>
<area shape="rect" id="node15" href="vegetation__dynamics_8f90.html#a275be9a740f6c74b8bf5e0a499cb6c49" title="vegetation_dynamics_eq_0" alt="" coords="860,192,1039,221"/>
<area shape="rect" id="node9" href="ed__model_8_f90.html#a9804b9ca3fcb1b4e17171d786d50c32c" title="Begins, updates, and outputs results from ecosystem simulation. " alt="" coords="1095,294,1172,324"/>
<area shape="rect" id="node11" href="ed__driver_8_f90.html#a5706bd8bee60960fe8166de1870e47da" title="ed_driver" alt="" coords="1227,294,1301,324"/>
<area shape="rect" id="node13" href="edmain_8_f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1349,294,1400,324"/>
<area shape="rect" id="node20" href="events_8f90.html#ad9f17e2da07d80a0734f81d8b2e27d25" title="prescribed_event" alt="" coords="665,504,785,533"/>
<area shape="rect" id="node28" href="namespaceed__init.html#a8181c9f2a37fc0800a7579090f3b3ed0" title="ed_init::load_ecosystem\l_state" alt="" coords="644,715,807,762"/>
<area shape="rect" id="node33" href="namespaceed__nbg__init.html#a301dee8c90b4ea9c4c259ac7bd6b97eb" title="ed_nbg_init::near_bare\l_ground_init" alt="" coords="423,883,575,930"/>
<area shape="rect" id="node44" href="ed__read__ed21__history_8_f90.html#ab0faf0a20947c74801841975108b59ba" title="read_ed21_history_file" alt="" coords="423,724,575,753"/>
<area shape="rect" id="node47" href="ed__read__ed21__history_8_f90.html#a7853e92e8b5f8ed0d9ad31f5259b3b8a" title="read_ed21_history_unstruct" alt="" coords="408,617,589,646"/>
<area shape="rect" id="node50" href="ed__read__ed21__history_8_f90.html#a1e9d28328ec655a6bcac03ee1618759a" title="read_ed21_polyclone" alt="" coords="427,670,571,700"/>
<area shape="rect" id="node53" href="events_8f90.html#ad9cbf1522be96cc9af2fbf80b1402d5c" title="event_harvest" alt="" coords="447,510,551,540"/>
<area shape="rect" id="node56" href="events_8f90.html#a344468d6236c4635f3bd01bc47acde4a" title="event_till" alt="" coords="461,564,536,593"/>
<area shape="rect" id="node61" href="namespacefuse__fiss__utils.html#aee30640ff825246fb4c9f5f1f41470be" title="This subroutine will perform patch fusion based on some similarity criteria to determine whether they..." alt="" coords="656,52,795,99"/>
<area shape="rect" id="node63" href="ed__init__atm_8_f90.html#a67ae59514caf7fea8936bca72628f5ca" title="ed_init_atm" alt="" coords="1089,172,1177,201"/>
</map>
</div>

</div>
</div>
<a id="a546d7beff2f991a07c8fbba91921ce5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a546d7beff2f991a07c8fbba91921ce5f">&#9670;&nbsp;</a></span>sort_patches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::sort_patches </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will sort the patches by age (1st = oldest, last = youngest.) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_a546d7beff2f991a07c8fbba91921ce5f_icgraph.png" border="0" usemap="#namespacefuse__fiss__utils_a546d7beff2f991a07c8fbba91921ce5f_icgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_a546d7beff2f991a07c8fbba91921ce5f_icgraph" id="namespacefuse__fiss__utils_a546d7beff2f991a07c8fbba91921ce5f_icgraph">
<area shape="rect" id="node3" href="namespacefuse__fiss__utils.html#aee30640ff825246fb4c9f5f1f41470be" title="This subroutine will perform patch fusion based on some similarity criteria to determine whether they..." alt="" coords="189,49,328,95"/>
<area shape="rect" id="node5" href="ed__init__atm_8_f90.html#a67ae59514caf7fea8936bca72628f5ca" title="ed_init_atm" alt="" coords="607,5,695,35"/>
<area shape="rect" id="node11" href="vegetation__dynamics_8f90.html#ab9ef01736ecab74cd0da4df6c2b63c0f" title="Handles vegetation growth, phenology, reproduction, and disturbance. " alt="" coords="395,57,539,87"/>
<area shape="rect" id="node16" href="vegetation__dynamics_8f90.html#a275be9a740f6c74b8bf5e0a499cb6c49" title="vegetation_dynamics_eq_0" alt="" coords="377,111,556,140"/>
<area shape="rect" id="node7" href="ed__driver_8_f90.html#a5706bd8bee60960fe8166de1870e47da" title="ed_driver" alt="" coords="744,32,819,61"/>
<area shape="rect" id="node9" href="edmain_8_f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="867,32,917,61"/>
<area shape="rect" id="node13" href="ed__model_8_f90.html#a9804b9ca3fcb1b4e17171d786d50c32c" title="Begins, updates, and outputs results from ecosystem simulation. " alt="" coords="612,59,689,88"/>
</map>
</div>

</div>
</div>
<a id="aba30221565235a7c9cdeadb079d324c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba30221565235a7c9cdeadb079d324c5">&#9670;&nbsp;</a></span>split_cohorts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::split_cohorts </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1patchtype.html">patchtype</a>), target&#160;</td>
          <td class="paramname"><em>cpatch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n_pft), intent(in)&#160;</td>
          <td class="paramname"><em>green_leaf_factor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will split two cohorts if its LAI has become too large. </p>
<p class="">This is only necessary when we solve radiation cohort by cohort rather than layer by layer. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_aba30221565235a7c9cdeadb079d324c5_cgraph.png" border="0" usemap="#namespacefuse__fiss__utils_aba30221565235a7c9cdeadb079d324c5_cgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_aba30221565235a7c9cdeadb079d324c5_cgraph" id="namespacefuse__fiss__utils_aba30221565235a7c9cdeadb079d324c5_cgraph">
<area shape="rect" id="node3" href="namespaceallometry.html#a56f11dc07da4d5e7114dc37d6cc5f2cc" title="allometry::dbh2h" alt="" coords="215,5,332,35"/>
<area shape="rect" id="node5" href="namespaceupdate__derived__props__module.html#a32f02a976fa5385f607cb4fa4d1aa552" title="update_derived_props\l_module::update_cohort\l_extensive_props" alt="" coords="193,59,353,123"/>
<area shape="rect" id="node7" href="namespacefuse__fiss__utils.html#a31e4835d2465d1400c7cbbb51976b341" title="This subroutine will sort the cohorts by size (1st = tallest, last = shortest.) " alt="" coords="205,146,341,193"/>
<area shape="rect" id="node9" href="fatal__error_8_f90.html#a2a2bff228716ab48a81c795b348d1665" title="fatal_error" alt="" coords="233,216,313,245"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_aba30221565235a7c9cdeadb079d324c5_icgraph.png" border="0" usemap="#namespacefuse__fiss__utils_aba30221565235a7c9cdeadb079d324c5_icgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_aba30221565235a7c9cdeadb079d324c5_icgraph" id="namespacefuse__fiss__utils_aba30221565235a7c9cdeadb079d324c5_icgraph">
<area shape="rect" id="node3" href="namespacefuse__fiss__utils.html#ad3a8f1f374137c79a74aed4b42bca8a9" title="This subroutine will merge two patches into 1. " alt="" coords="192,49,331,95"/>
<area shape="rect" id="node5" href="namespacefuse__fiss__utils.html#aee30640ff825246fb4c9f5f1f41470be" title="This subroutine will perform patch fusion based on some similarity criteria to determine whether they..." alt="" coords="379,49,517,95"/>
<area shape="rect" id="node7" href="ed__init__atm_8_f90.html#a67ae59514caf7fea8936bca72628f5ca" title="ed_init_atm" alt="" coords="796,5,884,35"/>
<area shape="rect" id="node13" href="vegetation__dynamics_8f90.html#ab9ef01736ecab74cd0da4df6c2b63c0f" title="Handles vegetation growth, phenology, reproduction, and disturbance. " alt="" coords="584,57,728,87"/>
<area shape="rect" id="node18" href="vegetation__dynamics_8f90.html#a275be9a740f6c74b8bf5e0a499cb6c49" title="vegetation_dynamics_eq_0" alt="" coords="567,111,745,140"/>
<area shape="rect" id="node9" href="ed__driver_8_f90.html#a5706bd8bee60960fe8166de1870e47da" title="ed_driver" alt="" coords="933,32,1008,61"/>
<area shape="rect" id="node11" href="edmain_8_f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1056,32,1107,61"/>
<area shape="rect" id="node15" href="ed__model_8_f90.html#a9804b9ca3fcb1b4e17171d786d50c32c" title="Begins, updates, and outputs results from ecosystem simulation. " alt="" coords="801,59,879,88"/>
</map>
</div>

</div>
</div>
<a id="a5dc8f0ad95ff159ac69570ac55856524"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dc8f0ad95ff159ac69570ac55856524">&#9670;&nbsp;</a></span>terminate_cohorts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::terminate_cohorts </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>elim_nplant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>elim_lai</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will eliminate cohorts based on their sizes. This is intended to eliminate cohorts that have little contribution and thus we can speed up the run. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_a5dc8f0ad95ff159ac69570ac55856524_cgraph.png" border="0" usemap="#namespacefuse__fiss__utils_a5dc8f0ad95ff159ac69570ac55856524_cgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_a5dc8f0ad95ff159ac69570ac55856524_cgraph" id="namespacefuse__fiss__utils_a5dc8f0ad95ff159ac69570ac55856524_cgraph">
<area shape="rect" id="node3" href="namespacefuse__fiss__utils.html#a31e4835d2465d1400c7cbbb51976b341" title="This subroutine will sort the cohorts by size (1st = tallest, last = shortest.) " alt="" coords="221,5,357,51"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_a5dc8f0ad95ff159ac69570ac55856524_icgraph.png" border="0" usemap="#namespacefuse__fiss__utils_a5dc8f0ad95ff159ac69570ac55856524_icgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_a5dc8f0ad95ff159ac69570ac55856524_icgraph" id="namespacefuse__fiss__utils_a5dc8f0ad95ff159ac69570ac55856524_icgraph">
<area shape="rect" id="node3" href="ed__read__ed21__history_8_f90.html#ab0faf0a20947c74801841975108b59ba" title="read_ed21_history_file" alt="" coords="237,5,389,35"/>
<area shape="rect" id="node11" href="ed__read__ed21__history_8_f90.html#a7853e92e8b5f8ed0d9ad31f5259b3b8a" title="read_ed21_history_unstruct" alt="" coords="223,59,404,88"/>
<area shape="rect" id="node14" href="ed__read__ed21__history_8_f90.html#a1e9d28328ec655a6bcac03ee1618759a" title="read_ed21_polyclone" alt="" coords="241,112,385,141"/>
<area shape="rect" id="node17" href="events_8f90.html#ad9cbf1522be96cc9af2fbf80b1402d5c" title="event_harvest" alt="" coords="261,165,365,195"/>
<area shape="rect" id="node26" href="events_8f90.html#a344468d6236c4635f3bd01bc47acde4a" title="event_till" alt="" coords="276,219,351,248"/>
<area shape="rect" id="node29" href="namespacefuse__fiss__utils.html#ad3a8f1f374137c79a74aed4b42bca8a9" title="This subroutine will merge two patches into 1. " alt="" coords="244,271,383,318"/>
<area shape="rect" id="node5" href="namespaceed__init.html#a8181c9f2a37fc0800a7579090f3b3ed0" title="ed_init::load_ecosystem\l_state" alt="" coords="453,77,616,123"/>
<area shape="rect" id="node7" href="ed__driver_8_f90.html#a5706bd8bee60960fe8166de1870e47da" title="ed_driver" alt="" coords="1032,207,1107,236"/>
<area shape="rect" id="node9" href="edmain_8_f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1155,207,1205,236"/>
<area shape="rect" id="node19" href="events_8f90.html#ad9f17e2da07d80a0734f81d8b2e27d25" title="prescribed_event" alt="" coords="475,181,595,211"/>
<area shape="rect" id="node21" href="vegetation__dynamics_8f90.html#ab9ef01736ecab74cd0da4df6c2b63c0f" title="Handles vegetation growth, phenology, reproduction, and disturbance. " alt="" coords="683,181,827,211"/>
<area shape="rect" id="node23" href="ed__model_8_f90.html#a9804b9ca3fcb1b4e17171d786d50c32c" title="Begins, updates, and outputs results from ecosystem simulation. " alt="" coords="900,207,977,236"/>
<area shape="rect" id="node31" href="namespacefuse__fiss__utils.html#aee30640ff825246fb4c9f5f1f41470be" title="This subroutine will perform patch fusion based on some similarity criteria to determine whether they..." alt="" coords="465,257,604,303"/>
<area shape="rect" id="node33" href="ed__init__atm_8_f90.html#a67ae59514caf7fea8936bca72628f5ca" title="ed_init_atm" alt="" coords="895,273,983,303"/>
<area shape="rect" id="node37" href="vegetation__dynamics_8f90.html#a275be9a740f6c74b8bf5e0a499cb6c49" title="vegetation_dynamics_eq_0" alt="" coords="665,235,844,264"/>
</map>
</div>

</div>
</div>
<a id="a480df748f946b24daa940c15d72abfe2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a480df748f946b24daa940c15d72abfe2">&#9670;&nbsp;</a></span>terminate_patches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fuse_fiss_utils::terminate_patches </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structed__state__vars_1_1sitetype.html">sitetype</a>), target&#160;</td>
          <td class="paramname"><em>csite</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine will eliminate tiny or empty patches. This is intended to eliminate patches that have little contribution and thus we can speed up the run. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_a480df748f946b24daa940c15d72abfe2_cgraph.png" border="0" usemap="#namespacefuse__fiss__utils_a480df748f946b24daa940c15d72abfe2_cgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_a480df748f946b24daa940c15d72abfe2_cgraph" id="namespacefuse__fiss__utils_a480df748f946b24daa940c15d72abfe2_cgraph">
<area shape="rect" id="node3" href="fatal__error_8_f90.html#a2a2bff228716ab48a81c795b348d1665" title="fatal_error" alt="" coords="221,13,301,43"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefuse__fiss__utils_a480df748f946b24daa940c15d72abfe2_icgraph.png" border="0" usemap="#namespacefuse__fiss__utils_a480df748f946b24daa940c15d72abfe2_icgraph" alt=""/></div>
<map name="namespacefuse__fiss__utils_a480df748f946b24daa940c15d72abfe2_icgraph" id="namespacefuse__fiss__utils_a480df748f946b24daa940c15d72abfe2_icgraph">
<area shape="rect" id="node3" href="ed__driver_8_f90.html#acbe29092ab1909380268a871fae36f22" title="exterminate_patches\l_except" alt="" coords="449,5,591,51"/>
<area shape="rect" id="node9" href="namespaceforestry.html#aea994fba45d5e5f01f0abe99d4d1493a" title="forestry::find_harvest_area" alt="" coords="223,75,399,104"/>
<area shape="rect" id="node5" href="ed__driver_8_f90.html#a5706bd8bee60960fe8166de1870e47da" title="ed_driver" alt="" coords="997,40,1072,69"/>
<area shape="rect" id="node7" href="edmain_8_f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="main" alt="" coords="1120,40,1171,69"/>
<area shape="rect" id="node11" href="namespacedisturbance__utils.html#a29d6db4e94463404643e5c3666c67767" title="disturbance_utils::\lapply_disturbances" alt="" coords="453,74,587,121"/>
<area shape="rect" id="node13" href="vegetation__dynamics_8f90.html#ab9ef01736ecab74cd0da4df6c2b63c0f" title="Handles vegetation growth, phenology, reproduction, and disturbance. " alt="" coords="659,65,803,95"/>
<area shape="rect" id="node18" href="vegetation__dynamics_8f90.html#a275be9a740f6c74b8bf5e0a499cb6c49" title="vegetation_dynamics_eq_0" alt="" coords="641,119,820,148"/>
<area shape="rect" id="node15" href="ed__model_8_f90.html#a9804b9ca3fcb1b4e17171d786d50c32c" title="Begins, updates, and outputs results from ecosystem simulation. " alt="" coords="871,65,948,95"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
